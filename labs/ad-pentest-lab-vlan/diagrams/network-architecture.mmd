graph TD
    %% Internet
    INTERNET[(Internet)]

    %% Firewall
    PF[pfsense<br/>Firewall / Router]

    INTERNET --> PF

    %% VLAN 10 – Management / AD
    subgraph VLAN10["VLAN 10 – Management / AD (172.28.10.0/24)"]
        DC01[DC01<br/>Domain Controller]
        CA01[CA01<br/>AD CS]
        DB01[DB01<br/>SQL Server]
    end

    %% VLAN 20 – Workstations
    subgraph VLAN20["VLAN 20 – Workstations (172.28.20.0/24)"]
        WIN10[WIN10<br/>User Workstation]
    end

    %% VLAN 30 – Servers & DevOps
    subgraph VLAN30["VLAN 30 – Servers & DevOps (172.28.30.0/24)"]
        PTP[pentestplus-target]
        PJPT[pjpt-target]
        OSCP[oscp-target]
        CLOUD[cloud-pentest]
        PNPT[pnpt-internal]
        LLM[LLM01]
    end

    %% VLAN 40 – DMZ
    subgraph VLAN40["VLAN 40 – DMZ (172.28.40.0/24)"]
        MSF2[metasploitable2]
        MSF3U[metasploitable3-ubuntu]
        MSF3W[metasploitable3-win2k8]
        JUICE[OWASP Juice Shop]
    end

    %% VLAN 99 – Attacker
    subgraph VLAN99["VLAN 99 – Attacker (172.28.99.0/24)"]
        KALI[Kali Linux<br/>Red Team]
    end

    %% Routing
    PF --- DC01
    PF --- CA01
    PF --- DB01
    PF --- WIN10
    PF --- PTP
    PF --- PJPT
    PF --- OSCP
    PF --- CLOUD
    PF --- PNPT
    PF --- LLM
    PF --- MSF2
    PF --- MSF3U
    PF --- MSF3W
    PF --- JUICE
    PF --- KALI
